/*
 * Copyright 2011 Freescale Semiconductor, Inc.
 * Copyright 2011 Linaro Ltd.
 * Copyright 2012 Genesi USA, Inc.
 *
 * The code contained herein is licensed under the GNU General Public
 * License. You may obtain a copy of the GNU General Public License
 * Version 2 or later at the following locations:
 *
 * http://www.opensource.org/licenses/gpl-license.html
 * http://www.gnu.org/copyleft/gpl.html
 */

/dts-v1/;
/include/ "imx51.dtsi"

/ {
	model = "Genesi Efika MX (Smarttop)";
	compatible = "genesi,imx51-efikamx", "fsl,imx51";

	memory {
		reg = <0x90000000 0x20000000>;
	};

	soc {
		aips@70000000 {
			spba@70000000 {
				esdhc1: esdhc@70004000 {
					pinctrl-names = "default";
					pinctrl-0 = <&pinctrl_esdhc1_1>;
					cd-gpios = <&gpio1 0 0>;
					wp-gpios = <&gpio1 1 0>;
					status = "okay";
				};

				ssi2: ssi@70014000 {
					fsl,mode = "i2s-slave";
					status = "okay";
				};

				ecspi1: ecspi@70010000 {
					pinctrl-names = "default";
					pinctrl-0 = <&pinctrl_ecspi1_1>;
					fsl,spi-num-chipselects = <2>;
					reg = <0x70010000 0x4000>;
					cs-gpios = <&gpio4 24 0>, /* GPIO4_24 */
						   <&gpio4 25 0>; /* GPIO4_25 */
					status = "okay";

					pmic: mc13892@0 {
						#address-cells = <1>;
						#size-cells = <0>;
						compatible = "fsl,mc13892";
						spi-max-frequency = <6000000>;
						reg = <0>;
						interrupt-parent = <&gpio1>;
						interrupts = <6 0x4>;
						fsl,mc13xxx-uses-rtc;

						regulators {
							reg_VDDGP: sw1 {
								/* VDDGP - PUS_4 (i.MX51) */
								regulator-name = "VDDGP";
								regulator-min-microvolt = <850000>;
								regulator-max-microvolt = <1100000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_VCC: sw2 {
								/* VCC - PUS_0 (peripherals) */
								regulator-name = "VCC";
								regulator-min-microvolt = <1225000>;
								regulator-max-microvolt = <1225000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_1V2_DIG1: sw3 {
								/* 1V2_DIG1 - PUS_5 (1.2V IO supply) */
								regulator-name = "1V2_DIG1";
								regulator-min-microvolt = <1200000>;
								regulator-max-microvolt = <1200000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_1V8_DIG1: sw4 {
								/* 1V8_DIG1 - PUS_1 (1.8V IO supply) */
								regulator-name = "1V8_DIG1";
								regulator-min-microvolt = <1800000>;
								regulator-max-microvolt = <1800000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_1V8_ANA_PLL: vpll {
								/* 1V8_ANA_PLL - PUS_6 (PLL supply) */
								regulator-name = "1V8_ANA_PLL";
								regulator-min-microvolt = <1800000>;
								regulator-max-microvolt = <1800000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_1V65: vdig {
								/* 1V65 - PUS_7 (SGTL5000-VDDA) */
								regulator-name = "1V65";
								regulator-min-microvolt = <1650000>;
								regulator-max-microvolt = <1650000>;
							};

							reg_3V15: vsd {
								/* 3V15 - possible supplement to 3V15_BOOT */
								regulator-name = "3V15";
								regulator-min-microvolt = <3150000>;
								regulator-max-microvolt = <3150000>;
								regulator-always-on;
							};

							reg_3V3_USB: vusb {
								/* 3V3_USB_MX51 - PUS_9 (UTMI PHY) */
								regulator-name = "3V3_USB";
								regulator-min-microvolt = <3300000>;
								regulator-max-microvolt = <3300000>;
								regulator-always-on;
							};

							reg_2V6: vusb2 {
								/* 2V6 - PUS_9 - (VCCUSBPHY) */
								regulator-name = "2V6";
								regulator-min-microvolt = <2600000>;
								regulator-max-microvolt = <2600000>;
								regulator-always-on;
							};

							reg_2V775: vvideo {
								/* 2V775 - supplement to 2V775_BOOT */
								regulator-name = "2V775";
								regulator-min-microvolt = <2775000>;
								regulator-max-microvolt = <2775000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_3V_ANA: vaudio {
								/* 3V_ANA - ??? */
								regulator-name = "3V_ANA";
								regulator-min-microvolt = <3000000>;
								regulator-max-microvolt = <3000000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_2V5: vcam {
								/* 2V5 - ??? */
								regulator-name = "2V5";
								regulator-min-microvolt = <2500000>;
								regulator-max-microvolt = <2500000>;
							};

							reg_1V2_DIG2: vgen1 {
								/* 1V2_DIG2 - (HDMI, VGA, SGTL5000-VDDD) */
								regulator-name = "1V2_DIG2";
								regulator-min-microvolt = <1200000>;
								regulator-max-microvolt = <1200000>;
							};

							reg_3V15_BOOT: vgen2 {
								/* 3V15_BOOT - PUS_3 - (3.15V IO supply, SD card, VDD_FUSE) */
								regulator-name = "3V15_BOOT";
								regulator-min-microvolt = <3150000>;
								regulator-max-microvolt = <3150000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_1V8_DIG2: vgen3 {
								/* 1V8_DIG2 - (1.8V IO supply) */
								regulator-name = "1V8_DIG2";
								regulator-min-microvolt = <1800000>;
								regulator-max-microvolt = <1800000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_2V775_BOOT: vviohi {
								/* 2V775_BOOT - PUS_2 */
								regulator-name = "2V775_BOOT";
								regulator-min-microvolt = <2775000>;
								regulator-max-microvolt = <2775000>;
								regulator-boot-on;
								regulator-always-on;
							};

							reg_LICELL: vcoincell {
								regulator-name = "LICELL";
								regulator-min-microvolt = <3000000>;
								regulator-max-microvolt = <3000000>;
								regulator-boot-on;
								regulator-always-on;
							};

						};
					};

					flash: sst25vf032b@1 {
						#address-cells = <1>;
						#size-cells = <1>;
						compatible = "sst,sst25vf032b";
						spi-max-frequency = <25000000>;
						reg = <1>;

						partition@0 {
							label = "firmware";
							rebig = <0x0 0x200000>;
						};

						partition@200000 {
							label = "user";
							reg = <0x200000 0x200000>;
						};
					};
				};
			};

			wdog1: wdog@73f98000 {
				status = "okay";
			};

			iomuxc: iomuxc@73fa8000 {
				compatible = "fsl,imx51-iomuxc";
				reg = <0x73fa8000 0x4000>;

				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_hog>;

				hog {
					pinctrl_hog: hoggrp {
						fsl,pins = <
							169 0x800000c0	/* MX51_PAD_EIM_DTACK__GPIO2_31 (Power button) */
							51 0x85		/* MX51_PAD_NANDF_RB3__GPIO_3_11 + 100k pullup (PCBID2) */
							53 0x85		/* MX51_PAD_NANDF_CS0__GPIO_3_16 + 100k pullup (PCBID0) */
							54 0x85		/* MX51_PAD_NANDF_CS1__GPIO_3_17 + 100k pullup (PCBID1) */
							402 0x85	/* MX51_PAD_CSPI1_SS0__GPIO4_24 */
							405 0x85	/* MX51_PAD_CSPI1_SS1__GPIO4_25 */
							694 0x85	/* MX51_PAD_GPIO1_0__SD1_CD */
							697 0x85	/* MX51_PAD_GPIO1_1__SD1_WP */
							740 0x85	/* MX51_PAD_GPIO1_6__GPIO1_6 (PMIC interrupt)*/
							737 0x80000000	/* MX51_PAD_GPIO1_5__GPIO1_5 (USB hub reset, 0 = reset) */
							63  0x80000000	/* MX51_PAD_EIM_D27__GPIO2_9 (USB phy reset, 0 = reset) */
						>;
					};
				};
			};

			uart1: serial@73fbc000 {
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_uart1_1>;
				fsl,uart-has-rtscts;
				status = "okay";
			};

		};

		aips@80000000 {
			sdma: sdma@83fb0000 {
				fsl,sdma-ram-script-name = "imx/sdma/sdma-imx51.bin";
			};

			i2c2: i2c@83fc4000 {
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_i2c2_1>;
				status = "okay";

				codec: sgtl5000@0a {
					compatible = "fsl,sgtl5000";
					reg = <0x0a>;
					clock-frequency = <12288000>;
					VDDA-supply = <&reg_1V65>;
					VDDIO-supply = <&reg_2V775>;
					VDDD-supply = <&reg_1V2_DIG2>;
				};
			};

			audmux: audmux@83fd0000 {
				pinctrl-names = "default";
				pinctrl-0 = <&pinctrl_audmux_1>;
				status = "okay";
			};
		};
	};

	gpio-keys {
		compatible = "gpio-keys";

		power {
			label = "Power Button";
			gpios = <&gpio2 31 0>;
			linux,code = <116>; /* KEY_POWER */
			gpio-key,wakeup;
		};
	};

	gpio-leds {
		compatible = "gpio-leds";

		red {
			label = "red";
			gpios = <&gpio3 13>;
			linux,default-trigger = "ide-disk";
		};

		green {
			label = "green";
			gpios = <&gpio3 14>;
			linux,default-trigger = "default-on";
		};

		blue {
			label = "blue";
			gpios = <&gpio3 15>;
			linux,default-trigger = "mmc0";
		};
	};

	sound {
		compatible = "fsl,imx-audio-sgtl5000";
		model = "efikamx-sgtl5000";
		ssi-controller = <&ssi2>;
		audio-routing =
			"MIC_IN", "Mic Jack",
			"Mic Jack", "Mic Bias",
			"Ext Spk", "LINE_OUT";
		audio-codec = <&codec>;
		mux-int-port = <2>;
		mux-ext-port = <3>;
	};
};

&pata {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_pata_1>;
	status = "okay";
};
